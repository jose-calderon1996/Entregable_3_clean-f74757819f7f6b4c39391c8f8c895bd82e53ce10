{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/jose/Desktop/Entregable_3_clean/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/auth.service\";\nimport * as i2 from \"@ionic/angular\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/forms\";\nexport let RegistroEstudiantilPage = /*#__PURE__*/(() => {\n  class RegistroEstudiantilPage {\n    constructor(authService, loadingController, toastController, navCtrl, router) {\n      this.authService = authService;\n      this.loadingController = loadingController;\n      this.toastController = toastController;\n      this.navCtrl = navCtrl;\n      this.router = router;\n      this.datosUsuario = {\n        nombre: '',\n        comuna: '',\n        direccion: '',\n        fechaNacimiento: '',\n        carrera: '',\n        correo: '',\n        contrasena: ''\n      };\n    }\n    ngOnInit() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        _this.datosUsuario;\n      })();\n    }\n    registrar() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        // Validación de campos\n        if (!_this2.datosUsuario.nombre || !_this2.datosUsuario.comuna || !_this2.datosUsuario.direccion || !_this2.datosUsuario.fechaNacimiento || !_this2.datosUsuario.carrera || !_this2.datosUsuario.correo || !_this2.datosUsuario.contrasena) {\n          _this2.mostrarToast('Por favor, completa todos los campos');\n          return;\n        }\n        // Mostrar animación de \"Registrando usuario\"\n        const loading = yield _this2.loadingController.create({\n          message: 'Registrando usuario...',\n          duration: 3000 // Duración máxima de la animación de carga: 3 segundos\n        });\n        yield loading.present();\n        try {\n          // Registro de usuario en Firebase Authentication\n          const userCredential = yield _this2.authService.register(_this2.datosUsuario.correo, _this2.datosUsuario.contrasena);\n          if (userCredential.user) {\n            // Guardar datos adicionales en Firestore\n            yield _this2.authService.saveUserData(userCredential.user.uid, {\n              nombre: _this2.datosUsuario.nombre,\n              comuna: _this2.datosUsuario.comuna,\n              direccion: _this2.datosUsuario.direccion,\n              fechaNacimiento: _this2.datosUsuario.fechaNacimiento,\n              carrera: _this2.datosUsuario.carrera\n            });\n            _this2.mostrarToast('Registro exitoso');\n            _this2.navCtrl.navigateForward('/login'); // Navegar a la página de inicio de sesión\n          } else {\n            _this2.mostrarToast('Error en el registro');\n          }\n        } catch (error) {\n          // captura mi error de correo existente \n          if (error === 'auth/email-already-in-use') {\n            _this2.mostrarToast('El correo ya está en uso por otra cuenta');\n          } else {\n            _this2.mostrarToast('Error en el registro');\n            console.error('Error en el registro:', error);\n          }\n        } finally {\n          // Cerrar animación de carga independientemente del resultado\n          loading.dismiss();\n        }\n      })();\n    }\n    mostrarToast(message) {\n      var _this3 = this;\n      return _asyncToGenerator(function* () {\n        const toast = yield _this3.toastController.create({\n          message: message,\n          duration: 2000,\n          position: 'top',\n          color: 'danger'\n        });\n        yield toast.present();\n      })();\n    }\n    navigateToLogin() {\n      this.navCtrl.navigateBack('/login');\n    }\n    static {\n      this.ɵfac = function RegistroEstudiantilPage_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || RegistroEstudiantilPage)(i0.ɵɵdirectiveInject(i1.AuthService), i0.ɵɵdirectiveInject(i2.LoadingController), i0.ɵɵdirectiveInject(i2.ToastController), i0.ɵɵdirectiveInject(i2.NavController), i0.ɵɵdirectiveInject(i3.Router));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: RegistroEstudiantilPage,\n        selectors: [[\"app-registro-estudiantil\"]],\n        decls: 60,\n        vars: 7,\n        consts: [[\"slot\", \"start\"], [\"defaultHref\", \"/home\", \"color\", \"success\", \"icon-only\", \"true\"], [\"color\", \"success\", 1, \"ion-text-center\"], [1, \"ion-padding\", \"center-content\"], [3, \"ngSubmit\"], [\"size\", \"12\"], [\"color\", \"success\"], [\"type\", \"text\", \"name\", \"nombre\", \"required\", \"\", 3, \"ngModelChange\", \"ngModel\"], [\"color\", \"success\", \"position\", \"floating\"], [\"type\", \"email\", \"name\", \"correo\", \"required\", \"\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"text\", \"name\", \"comuna\", \"required\", \"\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"text\", \"name\", \"direccion\", \"required\", \"\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"date\", \"name\", \"fechaNacimiento\", \"required\", \"\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"text\", \"name\", \"carrera\", \"required\", \"\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"password\", \"name\", \"contrasena\", \"required\", \"\", 3, \"ngModelChange\", \"ngModel\"], [\"expand\", \"full\", \"type\", \"submit\", \"color\", \"success\"], [2, \"background-color\", \"white\", \"padding\", \"20px\", \"margin-top\", \"20px\", \"border-radius\", \"8px\", \"box-shadow\", \"0 2px 4px rgba(0,0,0,0.1)\"], [2, \"text-align\", \"center\", \"color\", \"#3880ff\"], [2, \"text-align\", \"justify\", \"color\", \"#333\"]],\n        template: function RegistroEstudiantilPage_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\")(2, \"ion-buttons\", 0);\n            i0.ɵɵelement(3, \"ion-back-button\", 1);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"ion-title\", 2);\n            i0.ɵɵtext(5, \"Registro Estudiantil\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(6, \"ion-content\", 3)(7, \"form\", 4);\n            i0.ɵɵlistener(\"ngSubmit\", function RegistroEstudiantilPage_Template_form_ngSubmit_7_listener() {\n              return ctx.registrar();\n            });\n            i0.ɵɵelementStart(8, \"ion-grid\")(9, \"ion-row\")(10, \"ion-col\", 5)(11, \"ion-item\")(12, \"ion-label\", 6);\n            i0.ɵɵtext(13, \"Nombre\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(14, \"ion-input\", 7);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function RegistroEstudiantilPage_Template_ion_input_ngModelChange_14_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.datosUsuario.nombre, $event) || (ctx.datosUsuario.nombre = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(15, \"ion-row\")(16, \"ion-col\", 5)(17, \"ion-item\")(18, \"ion-label\", 8);\n            i0.ɵɵtext(19, \"Correo\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(20, \"ion-input\", 9);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function RegistroEstudiantilPage_Template_ion_input_ngModelChange_20_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.datosUsuario.correo, $event) || (ctx.datosUsuario.correo = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(21, \"ion-row\")(22, \"ion-col\", 5)(23, \"ion-item\")(24, \"ion-label\", 8);\n            i0.ɵɵtext(25, \"Comuna\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(26, \"ion-input\", 10);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function RegistroEstudiantilPage_Template_ion_input_ngModelChange_26_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.datosUsuario.comuna, $event) || (ctx.datosUsuario.comuna = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(27, \"ion-row\")(28, \"ion-col\", 5)(29, \"ion-item\")(30, \"ion-label\", 8);\n            i0.ɵɵtext(31, \"Direcci\\u00F3n\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(32, \"ion-input\", 11);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function RegistroEstudiantilPage_Template_ion_input_ngModelChange_32_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.datosUsuario.direccion, $event) || (ctx.datosUsuario.direccion = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(33, \"ion-row\")(34, \"ion-col\", 5)(35, \"ion-item\")(36, \"ion-label\", 8);\n            i0.ɵɵtext(37, \"Fecha de Nacimiento\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(38, \"ion-input\", 12);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function RegistroEstudiantilPage_Template_ion_input_ngModelChange_38_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.datosUsuario.fechaNacimiento, $event) || (ctx.datosUsuario.fechaNacimiento = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(39, \"ion-row\")(40, \"ion-col\", 5)(41, \"ion-item\")(42, \"ion-label\", 8);\n            i0.ɵɵtext(43, \"Carrera\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(44, \"ion-input\", 13);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function RegistroEstudiantilPage_Template_ion_input_ngModelChange_44_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.datosUsuario.carrera, $event) || (ctx.datosUsuario.carrera = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(45, \"ion-row\")(46, \"ion-col\", 5)(47, \"ion-item\")(48, \"ion-label\", 8);\n            i0.ɵɵtext(49, \"Contrase\\u00F1a\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(50, \"ion-input\", 14);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function RegistroEstudiantilPage_Template_ion_input_ngModelChange_50_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.datosUsuario.contrasena, $event) || (ctx.datosUsuario.contrasena = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(51, \"ion-row\")(52, \"ion-col\", 5)(53, \"ion-button\", 15);\n            i0.ɵɵtext(54, \"Registrar\");\n            i0.ɵɵelementEnd()()()()();\n            i0.ɵɵelementStart(55, \"div\", 16)(56, \"h3\", 17);\n            i0.ɵɵtext(57, \"\\u00BFPor qu\\u00E9 registrarse?\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(58, \"p\", 18);\n            i0.ɵɵtext(59, \" Registrarse es el primer paso para acceder a todas las funcionalidades de nuestra aplicaci\\u00F3n. Al completar su registro, podr\\u00E1 asistir a clases de manera eficiente, recibir notificaciones importantes sobre su asistencia y acceder a recursos dise\\u00F1ados para facilitar su experiencia acad\\u00E9mica. \\u00A1No espere m\\u00E1s, reg\\u00EDstrese y forme parte de nuestra comunidad educativa! \");\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(14);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.datosUsuario.nombre);\n            i0.ɵɵadvance(6);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.datosUsuario.correo);\n            i0.ɵɵadvance(6);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.datosUsuario.comuna);\n            i0.ɵɵadvance(6);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.datosUsuario.direccion);\n            i0.ɵɵadvance(6);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.datosUsuario.fechaNacimiento);\n            i0.ɵɵadvance(6);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.datosUsuario.carrera);\n            i0.ɵɵadvance(6);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.datosUsuario.contrasena);\n          }\n        },\n        dependencies: [i4.ɵNgNoValidate, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.NgModel, i4.NgForm, i2.IonButton, i2.IonButtons, i2.IonCol, i2.IonContent, i2.IonGrid, i2.IonHeader, i2.IonInput, i2.IonItem, i2.IonLabel, i2.IonRow, i2.IonTitle, i2.IonToolbar, i2.TextValueAccessor, i2.IonBackButton],\n        encapsulation: 2\n      });\n    }\n  }\n  return RegistroEstudiantilPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}